var song,fft,button,songTime,centerx,centery,output,canvas,slider,width=1440,height=720,column=32,row=16,scaleOutput=1,colCount=width/column,rowCount=height/row,rayArray=[];function toggleSong(){song.isPlaying()?song.pause():song.play()}function preload(){song=loadSound("summer.mp3")}function setup(){centerx=12*colCount,centery=6*rowCount,songTime=song.duration(),createCanvas(1440,720),colorMode(HSB,255),angleMode(DEGREES),(button=createButton("toggle")).mousePressed(toggleSong);for(let t=1;t<row;t++)for(let e=1;e<column;e++){let o=e*colCount,r=t*rowCount,n=createVector(o-centerx,r-centery);n.normalize();let a=new Ray(o,r,n);rayArray.push(a)}fft=new p5.FFT(.5,column*row*4)}function draw(){if(song.isPlaying()){background(255),background(255);var t=fft.analyze();for(let e=0;e<rayArray.length;e++){let o=rayArray[e].getx(),r=rayArray[e].gety(),n=(mouseX,mouseY,createVector(o-mouseX,r-mouseY));n.normalize();let a=t[e],s=map(a,0,256,0,30),u=map(a,0,256,0,20),l=map(a,0,256,0,360);a>100&&(s=map(a,0,256,0,60),a>150&&(s=map(a,0,256,0,300)));let c=n.copy().mult(s),g=n.copy().mult(u),i=o+c.x,y=r+c.y,m=g.x,h=g.y;blendMode(MULTIPLY),stroke(l,255,255),strokeWeight(7),strokeCap(SQUARE),line(o+m,r+h,i,y),blendMode(BLEND)}}translate(width/2,height/2)}class Ray{constructor(t,e,o){this.x=t,this.y=e,this.v=o}push(t){this.v=t}getx(){return this.x}gety(){return this.y}getv(){return this.v}}